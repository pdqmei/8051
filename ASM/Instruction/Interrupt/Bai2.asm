ORG 0000H
JMP MAIN

ORG 001BH
JMP TIMER1_ISR

ORG 0030H
MAIN:
MOV TMOD, #20H

MOV TL1, #156
MOV TH1, #156

MOV R2, #50

SETB ET1
SETB EA

SETB P2.0

SETB TR1

LOOP:
JMP LOOP

TIMER1_ISR:
INC R1
CLR C
MOV A, R1
SUBB A,R2
JC PWM_HIGH

; R1 >= R2
CLR P2.0
JMP CHECK_CYCLE_END

PWM_HIGH:
SETB P2.0

CHECK_CYCLE_END:
CJNE R1, #100, EXIT_ISR
MOV R1, #0
SETB P2.0

EXIT_ISR:
RETI

END
